/**
 * Created by emilianoeloi on 5/4/14.
 */
var mysql      = require('mysql');
var connection = mysql.createConnection({
    host     : 'localhost',
    user     : 'essuser',
    password : 'essuser1',
    database : 'fxos_players'
});

connection.connect(function(err) {
    console.log('MySQL', 'error');
});

exports.insert = function(item, success, error){
    var query = connection.query('INSERT INTO categories SET ?', item, success, error);
}

exports.list = function(success, error){
    var queryString = 'SELECT * FROM categories';
    connection.query(queryString, function(err, rows, fields) {
        if (err) throw err;

        for (var i in rows) {
            console.log('Nerdcast Titles: ', rows[i].title);
        }
    });
}

exports.get = function(categoryModel, success, error){
    var fields = ['id','name'];
    var queryString = 'SELECT * FROM categories WHERE name = ?';
    connection.query(queryString, [categoryModel.name], function(err, rows, fields) {
        if (err) {
            error(err)
        } else {
            success(rows);
        }
    });
}